<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Web3Auth Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 600px; 
            margin: 50px auto; 
            padding: 20px; 
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #45a049; }
        #status {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>Web3Auth ê°„ë‹¨ í…ŒìŠ¤íŠ¸</h1>
    <button onclick="testLogin()">ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</button>
    <button onclick="clearAll()">ëª¨ë“  ë°ì´í„° í´ë¦¬ì–´</button>
    
    <div id="status">ì¤€ë¹„ ì¤‘...</div>

    <script>
        let web3auth = null;
        const clientId = "BKQkCcvERmw1_BoRMJ8frnhBV5snPap95qvfgzhfo1QLF4RHW2TwMqT1YxS_3PavJA6eOYJoO5W81-RO4J2CMNY";

        function updateStatus(message) {
            document.getElementById('status').innerHTML = message;
            console.log(message);
        }

        function clearAll() {
            localStorage.clear();
            sessionStorage.clear();
            updateStatus("ëª¨ë“  ë°ì´í„° í´ë¦¬ì–´ë¨. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.");
        }

        async function initWeb3Auth() {
            try {
                updateStatus("Web3Auth ì´ˆê¸°í™” ì¤‘...");
                
                web3auth = new window.Modal.Web3Auth({
                    clientId,
                    web3AuthNetwork: "sapphire_devnet",
                    chainConfig: {
                        chainNamespace: "eip155",
                        chainId: "0x5", // Goerli
                        rpcTarget: "https://rpc.ankr.com/eth_goerli",
                        displayName: "Ethereum Goerli",
                        blockExplorer: "https://goerli.etherscan.io",
                        ticker: "ETH",
                        tickerName: "Ethereum",
                    }
                });

                await web3auth.initModal();
                updateStatus("âœ… Web3Auth ì´ˆê¸°í™” ì™„ë£Œ! ë¡œê·¸ì¸ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.");
                
            } catch (error) {
                updateStatus(`âŒ ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`);
                console.error("Full error:", error);
            }
        }

        async function testLogin() {
            if (!web3auth) {
                updateStatus("ë¨¼ì € Web3Authë¥¼ ì´ˆê¸°í™”í•´ì£¼ì„¸ìš”.");
                return;
            }

            try {
                updateStatus("ğŸ” ë¡œê·¸ì¸ ì‹œë„ ì¤‘...");
                
                const provider = await web3auth.connect();
                
                if (provider) {
                    const user = await web3auth.getUserInfo();
                    updateStatus(`ğŸ‰ ë¡œê·¸ì¸ ì„±ê³µ!<br>
                        ì£¼ì†Œ: ${user.eoa}<br>
                        ì´ë©”ì¼: ${user.email || 'N/A'}<br>
                        ì´ë¦„: ${user.name || 'N/A'}`);
                } else {
                    updateStatus("ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                }
                
            } catch (error) {
                updateStatus(`âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${error.message}`);
                console.error("Login error details:", error);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            setTimeout(initWeb3Auth, 1000);
        });
    </script>

    <!-- CDNìœ¼ë¡œ Web3Auth ë¡œë“œ -->
    <script src="https://cdn.jsdelivr.net/npm/@web3auth/modal@7.3.2/dist/modal.umd.min.js"></script>
</body>
</html>